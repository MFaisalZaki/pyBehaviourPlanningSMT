import os
import argparse
import json
import importlib.util
from collections import defaultdict
from copy import deepcopy

from utilities import getkeyvalue, read_json_file


classical_instances = [
    "(2000, schedule, 9)",
    "(None, blocks-3op, 5)",
    "(2000, blocks, 58)",
    "(None, ferry, 17)",
    "(2011, sokoban, 17)",
    "(None, miconic, 43)",
    "(2006, rovers, 14)",
    "(None, miconic, 144)",
    "(2014, openstacks, 19)",
    "(2018, termes, 19)",
    "(None, tsp, 24)",
    "(2008, pegsol, 13)",
    "(None, openstacks, 16)",
    "(2018, organic-synthesis-split, 4)",
    "(2000, elevators, 13)",
    "(2004, satellite, 2)",
    "(2000, elevators, 131)",
    "(None, miconic, 39)",
    "(1998, gripper, 6)",
    "(2000, schedule, 131)",
    "(None, miconic, 50)",
    "(2004, psr-small, 16)",
    "(2008, sokoban, 11)",
    "(2014, hiking, 13)",
    "(2014, hiking, 3)",
    "(None, trucks, 5)",
    "(2004, satellite, 11)",
    "(2000, elevators, 69)",
    "(2008, cybersec, 26)",
    "(2008, openstacks, 11)",
    "(2011, nomystery, 13)",
    "(2002, driverlog, 15)",
    "(None, miconic, 7)",
    "(2000, elevators, 122)",
    "(None, openstacks, 7)",
    "(2008, openstacks, 5)",
    "(2004, pipesworld-tankage, 2)",
    "(2004, psr-small, 23)",
    "(None, miconic, 65)",
    "(2008, sokoban, 24)",
    "(None, ferry, 5)",
    "(None, miconic, 85)",
    "(2000, schedule, 12)",
    "(2000, elevators, 35)",
    "(2006, trucks, 8)",
    "(2008, openstacks, 24)",
    "(2002, driverlog, 20)",
    "(2004, pipesworld-tankage, 15)",
    "(2011, parcprinter, 2)",
    "(2014, openstacks, 1)",
    "(2018, organic-synthesis-split, 10)",
    "(None, miconic, 76)",
    "(2004, psr-small, 30)",
    "(2011, scanalyzer, 6)",
    "(2006, pipesworld, 8)",
    "(2014, ged, 17)",
    "(2002, depot, 16)",
    "(None, ferry, 22)",
    "(2011, sokoban, 3)",
    "(2011, openstacks, 18)",
    "(2002, zenotravel, 2)",
    "(2000, elevators, 26)",
    "(2008, pegsol, 26)",
    "(None, tsp, 11)",
    "(None, no-mprime, 9)",
    "(2006, openstacks, 8)",
    "(2018, snake, 11)",
    "(None, tsp, 5)",
    "(2000, elevators, 114)",
    "(2000, elevators, 36)",
    "(2011, parcprinter, 1)",
    "(2008, openstacks, 27)",
    "(2018, organic-synthesis-split, 13)",
    "(2008, cybersec, 10)",
    "(2002, rovers, 3)",
    "(2014, openstacks, 2)",
    "(2004, pipesworld-tankage, 1)",
    "(2008, sokoban, 27)",
    "(2004, psr-small, 20)",
    "(None, miconic, 66)",
    "(2018, nurikabe, 18)",
    "(2000, schedule, 11)",
    "(None, ferry, 6)",
    "(2000, schedule, 98)",
    "(1998, movie, 9)",
    "(1998, gripper, 18)",
    "(2004, psr-small, 49)",
    "(1998, movie, 28)",
    "(2000, elevators, 25)",
    "(2008, pegsol, 25)",
    "(None, tsp, 6)",
    "(None, miconic, 75)",
    "(2004, psr-small, 33)",
    "(None, ferry, 21)",
    "(2006, tpp, 8)",
    "(2011, barman, 9)",
    "(2014, visitall, 4)",
    "(2002, rovers, 12)",
    "(2008, pegsol, 9)",
    "(2000, elevators, 79)",
    "(2011, pegsol, 9)",
    "(None, openstacks, 15)",
    "(None, tsp, 27)",
    "(2008, pegsol, 10)",
    "(2000, elevators, 132)",
    "(2004, satellite, 1)",
    "(2000, elevators, 10)",
    "(2011, parcprinter, 14)",
    "(2004, airport, 7)",
    "(1998, logistics, 33)",
    "(None, ferry, 14)",
    "(None, fridge, 3)",
    "(None, miconic, 29)",
    "(2008, parcprinter, 8)",
    "(2000, schedule, 148)",
    "(None, briefcaseworld, 30)",
    "(2006, rovers, 3)",
    "(2002, depot, 20)",
    "(2011, sokoban, 14)",
    "(None, miconic, 147)",
    "(None, miconic, 40)",
    "(2011, visitall, 3)",
    "(2000, elevators, 148)",
    "(2008, cybersec, 25)",
    "(2002, driverlog, 16)",
    "(2008, openstacks, 12)",
    "(2000, elevators, 121)",
    "(None, openstacks, 4)",
    "(2008, openstacks, 6)",
    "(1998, gripper, 5)",
    "(2000, schedule, 24)",
    "(2000, schedule, 132)",
    "(2018, termes, 8)",
    "(2008, sokoban, 12)",
    "(None, miconic, 53)",
    "(2004, psr-small, 15)",
    "(None, trucks, 6)",
    "(2004, satellite, 12)",
    "(2014, hiking, 10)",
    "(2000, elevators, 23)",
    "(1998, assembly, 8)",
    "(2000, freecell, 38)",
    "(None, tsp, 14)",
    "(2011, scanalyzer, 3)",
    "(2004, psr-small, 35)",
    "(None, miconic, 73)",
    "(2014, visitall, 2)",
    "(None, ferry, 27)",
    "(2011, sokoban, 6)",
    "(2004, pipesworld-tankage, 10)",
    "(2011, parcprinter, 7)",
    "(2008, openstacks, 21)",
    "(2000, elevators, 112)",
    "(2000, elevators, 30)",
    "(2008, pegsol, 30)",
    "(2000, elevators, 59)",
    "(2014, openstacks, 4)",
    "(2008, sokoban, 21)",
    "(2000, blocks, 12)",
    "(2004, psr-small, 26)",
    "(2004, pipesworld-tankage, 7)",
    "(2000, schedule, 17)",
    "(2011, pegsol, 19)",
    "(2014, childsnack, 2)",
    "(2011, visitall, 5)",
    "(2018, organic-synthesis-split, 20)",
    "(2008, sokoban, 9)",
    "(None, openstacks, 2)",
    "(2000, elevators, 127)",
    "(2000, elevators, 9)",
    "(2008, openstacks, 14)",
    "(1998, gripper, 3)",
    "(None, briefcaseworld, 25)",
    "(2014, hiking, 6)",
    "(2014, hiking, 16)",
    "(2008, sokoban, 14)",
    "(2004, psr-small, 13)",
    "(None, miconic, 55)",
    "(2018, organic-synthesis-split, 1)",
    "(None, openstacks, 13)",
    "(None, tsp, 21)",
    "(2008, pegsol, 16)",
    "(2002, rovers, 14)",
    "(2004, pipesworld-notankage, 8)",
    "(2004, satellite, 7)",
    "(2000, elevators, 134)",
    "(2002, zenotravel, 16)",
    "(2000, elevators, 16)",
    "(None, miconic, 128)",
    "(None, ferry, 12)",
    "(2018, organic-synthesis, 10)",
    "(None, miconic, 141)",
    "(None, miconic, 46)",
    "(2006, rovers, 11)",
    "(2006, rovers, 5)",
    "(2011, sokoban, 12)",
    "(2000, schedule, 21)",
    "(None, miconic, 138)",
    "(None, briefcaseworld, 26)",
    "(None, trucks, 3)",
    "(2014, hiking, 5)",
    "(2008, sokoban, 17)",
    "(None, openstacks, 1)",
    "(2000, elevators, 124)",
    "(2008, openstacks, 3)",
    "(2008, openstacks, 17)",
    "(2011, nomystery, 15)",
    "(None, blocks-3op, 3)",
    "(None, ferry, 11)",
    "(2018, petri-net-alignment, 18)",
    "(2018, organic-synthesis, 13)",
    "(None, miconic, 45)",
    "(2006, rovers, 12)",
    "(None, miconic, 142)",
    "(2011, sokoban, 11)",
    "(2006, rovers, 6)",
    "(2004, airport, 18)",
    "(None, tsp, 22)",
    "(2008, pegsol, 15)",
    "(None, openstacks, 10)",
    "(2002, rovers, 17)",
    "(2011, parcprinter, 11)",
    "(2000, elevators, 15)",
    "(2000, elevators, 137)",
    "(2004, satellite, 4)",
    "(2002, zenotravel, 15)",
    "(1998, movie, 18)",
    "(2014, ged, 11)",
    "(2011, openstacks, 9)",
    "(2004, psr-small, 36)",
    "(None, miconic, 70)",
    "(2002, zenotravel, 4)",
    "(None, miconic, 19)",
    "(None, ferry, 24)",
    "(2011, sokoban, 5)",
    "(2000, elevators, 20)",
    "(2002, zenotravel, 20)",
    "(2018, snake, 17)",
    "(2000, elevators, 49)",
    "(None, tsp, 3)",
    "(2008, pegsol, 20)",
    "(None, tsp, 17)",
    "(None, openstacks, 25)",
    "(None, miconic, 63)",
    "(2008, sokoban, 22)",
    "(2000, blocks, 11)",
    "(2004, pipesworld-tankage, 4)",
    "(2000, blocks, 8)",
    "(2014, childsnack, 1)",
    "(None, miconic, 83)",
    "(2000, schedule, 14)",
    "(2008, scanalyzer, 27)",
    "(2008, openstacks, 22)",
    "(2004, pipesworld-tankage, 13)",
    "(2011, parcprinter, 4)",
    "(2000, elevators, 33)",
    "(2000, elevators, 111)",
    "(2000, freecell, 28)",
    "(2002, rovers, 6)",
    "(2014, openstacks, 7)",
    "(2014, barman, 6)",
    "(1998, mprime, 21)",
    "(2008, scanalyzer, 5)",
    "(2008, openstacks, 18)",
    "(2000, elevators, 5)",
    "(2011, visitall, 9)",
    "(2006, openstacks, 14)",
    "(2008, sokoban, 5)",
    "(2000, elevators, 142)",
    "(2000, elevators, 60)",
    "(None, briefcaseworld, 29)",
    "(2018, petri-net-alignment, 3)",
    "(2004, satellite, 18)",
    "(2018, termes, 2)",
    "(2008, sokoban, 18)",
    "(2011, pegsol, 20)",
    "(None, miconic, 137)",
    "(2004, pipesworld-notankage, 10)",
    "(None, miconic, 30)",
    "(2000, elevators, 138)",
    "(1998, movie, 17)",
    "(None, pathways-noneg, 6)",
    "(2018, termes, 10)",
    "(2014, openstacks, 10)",
    "(2002, rovers, 18)",
    "(2004, pipesworld-notankage, 4)",
    "(2000, elevators, 73)",
    "(2000, schedule, 142)",
    "(2004, airport, 17)",
    "(2006, rovers, 9)",
    "(None, miconic, 124)",
    "(None, miconic, 23)",
    "(2008, parcprinter, 2)",
    "(2018, petri-net-alignment, 17)",
    "(2000, freecell, 34)",
    "(2000, elevators, 46)",
    "(2006, openstacks, 1)",
    "(None, tsp, 18)",
    "(1998, movie, 22)",
    "(2011, visitall, 14)",
    "(1998, assembly, 4)",
    "(2006, tpp, 2)",
    "(2011, barman, 3)",
    "(None, miconic, 111)",
    "(2011, openstacks, 11)",
    "(2011, scanalyzer, 14)",
    "(None, miconic, 16)",
    "(2004, psr-small, 50)",
    "(2011, openstacks, 6)",
    "(2004, airport, 22)",
    "(2006, pipesworld, 1)",
    "(2004, psr-small, 39)",
    "(None, trucks, 12)",
    "(2018, organic-synthesis-split, 19)",
    "(2000, freecell, 27)",
    "(2014, openstacks, 8)",
    "(2000, elevators, 55)",
    "(2006, trucks, 1)",
    "(2008, parcprinter, 23)",
    "(2011, nomystery, 3)",
    "(2000, blocks, 7)",
    "(1998, movie, 3)",
    "(1998, gripper, 12)",
    "(2004, psr-small, 43)",
    "(2006, pathways, 4)",
    "(2011, pegsol, 15)",
    "(None, miconic, 15)",
    "(2011, sokoban, 9)",
    "(None, ferry, 28)",
    "(None, miconic, 112)",
    "(2011, openstacks, 12)",
    "(2006, pipesworld, 2)",
    "(2011, openstacks, 5)",
    "(2004, airport, 21)",
    "(2000, freecell, 37)",
    "(2000, elevators, 45)",
    "(2014, ged, 4)",
    "(2006, openstacks, 2)",
    "(1998, assembly, 7)",
    "(1998, movie, 21)",
    "(2004, psr-small, 3)",
    "(1998, gripper, 11)",
    "(2004, psr-small, 40)",
    "(2002, driverlog, 2)",
    "(2000, blocks, 4)",
    "(2011, pegsol, 16)",
    "(2000, schedule, 18)",
    "(2004, psr-small, 29)",
    "(2004, pipesworld-tankage, 8)",
    "(None, trucks, 11)",
    "(2000, freecell, 24)",
    "(2000, elevators, 56)",
    "(2011, parcprinter, 8)",
    "(2006, trucks, 2)",
    "(2014, hiking, 19)",
    "(2014, hiking, 9)",
    "(2018, nurikabe, 3)",
    "(2018, termes, 1)",
    "(2018, organic-synthesis, 1)",
    "(None, blocks-3op, 28)",
    "(2004, pipesworld-notankage, 13)",
    "(None, miconic, 33)",
    "(None, miconic, 134)",
    "(2014, barman, 5)",
    "(2000, elevators, 128)",
    "(2000, elevators, 83)",
    "(2000, elevators, 6)",
    "(2008, scanalyzer, 6)",
    "(2000, elevators, 63)",
    "(2006, openstacks, 17)",
    "(2008, sokoban, 6)",
    "(2000, elevators, 141)",
    "(None, miconic, 49)",
    "(2000, schedule, 141)",
    "(2004, airport, 14)",
    "(None, miconic, 20)",
    "(2000, schedule, 3)",
    "(None, miconic, 127)",
    "(2014, thoughtful, 3)",
    "(2000, elevators, 19)",
    "(None, pathways-noneg, 5)",
    "(2002, zenotravel, 19)",
    "(2004, satellite, 8)",
    "(1998, movie, 14)",
    "(2006, pipesworld, 15)",
    "(2000, elevators, 70)",
    "(2018, termes, 13)",
    "(2014, openstacks, 13)",
    "(2004, pipesworld-notankage, 7)",
    "(None, ferry, 9)",
    "(2014, visitall, 16)",
    "(1998, gripper, 17)",
    "(2004, psr-small, 46)",
    "(2002, driverlog, 4)",
    "(2006, pathways, 1)",
    "(2000, blocks, 2)",
    "(2018, snake, 6)",
    "(2000, schedule, 97)",
    "(1998, movie, 6)",
    "(2018, nurikabe, 17)",
    "(None, miconic, 69)",
    "(2008, sokoban, 28)",
    "(2000, freecell, 22)",
    "(2000, elevators, 50)",
    "(2000, elevators, 39)",
    "(2008, parcprinter, 26)",
    "(2006, trucks, 4)",
    "(2008, openstacks, 28)",
    "(None, miconic, 13)",
    "(2011, openstacks, 14)",
    "(2011, scanalyzer, 11)",
    "(None, miconic, 114)",
    "(2011, barman, 6)",
    "(None, no-mprime, 12)",
    "(2006, tpp, 7)",
    "(2006, pipesworld, 4)",
    "(2000, schedule, 64)",
    "(2011, openstacks, 3)",
    "(2006, openstacks, 4)",
    "(2000, freecell, 31)",
    "(2000, elevators, 43)",
    "(2014, ged, 2)",
    "(2014, openstacks, 20)",
    "(2018, termes, 20)",
    "(None, tsp, 9)",
    "(2004, psr-small, 5)",
    "(1998, assembly, 1)",
    "(1998, movie, 27)",
    "(2000, schedule, 147)",
    "(2004, airport, 12)",
    "(None, miconic, 148)",
    "(2014, thoughtful, 5)",
    "(2018, petri-net-alignment, 12)",
    "(2018, organic-synthesis, 19)",
    "(2002, depot, 2)",
    "(None, miconic, 26)",
    "(2008, parcprinter, 7)",
    "(2000, schedule, 5)",
    "(None, miconic, 121)",
    "(2000, blocks, 54)",
    "(None, pathways-noneg, 3)",
    "(1998, movie, 12)",
    "(2004, airport, 8)",
    "(2000, elevators, 76)",
    "(2018, termes, 15)",
    "(2004, pipesworld-notankage, 1)",
    "(2014, openstacks, 15)",
    "(None, tsp, 28)",
    "(2011, pegsol, 6)",
    "(2006, pipesworld, 13)",
    "(1998, mprime, 9)",
    "(2018, termes, 7)",
    "(2018, petri-net-alignment, 6)",
    "(None, trucks, 9)",
    "(2004, pipesworld-notankage, 15)",
    "(None, miconic, 35)",
    "(None, miconic, 132)",
    "(2000, elevators, 85)",
    "(2002, driverlog, 19)",
    "(2008, parcprinter, 13)",
    "(2014, barman, 3)",
    "(1998, mprime, 24)",
    "(2008, openstacks, 9)",
    "(2000, elevators, 65)",
    "(2006, openstacks, 11)",
    "(2000, elevators, 147)",
    "(1998, movie, 11)",
    "(2018, termes, 16)",
    "(2004, pipesworld-notankage, 2)",
    "(2014, openstacks, 16)",
    "(2000, elevators, 75)",
    "(2011, pegsol, 5)",
    "(2006, pipesworld, 10)",
    "(None, openstacks, 19)",
    "(2011, barman, 11)",
    "(2000, schedule, 144)",
    "(2011, sokoban, 18)",
    "(2018, petri-net-alignment, 11)",
    "(None, miconic, 122)",
    "(None, ferry, 18)",
    "(None, miconic, 25)",
    "(2002, depot, 1)",
    "(2008, parcprinter, 4)",
    "(2000, schedule, 6)",
    "(2008, scanalyzer, 3)",
    "(2000, elevators, 3)",
    "(None, openstacks, 8)",
    "(None, miconic, 8)",
    "(1998, logistics, 1)",
    "(2006, openstacks, 12)",
    "(2000, elevators, 144)",
    "(2008, sokoban, 3)",
    "(2000, elevators, 66)",
    "(2004, psr-small, 19)",
    "(2018, petri-net-alignment, 5)",
    "(None, miconic, 131)",
    "(1998, gripper, 9)",
    "(2004, pipesworld-notankage, 16)",
    "(None, miconic, 36)",
    "(2018, organic-synthesis, 4)",
    "(2000, freecell, 21)",
    "(2008, cybersec, 9)",
    "(2000, elevators, 53)",
    "(2006, trucks, 7)",
    "(1998, mprime, 12)",
    "(2008, parcprinter, 25)",
    "(2000, blocks, 1)",
    "(1998, movie, 5)",
    "(1998, gripper, 14)",
    "(2004, psr-small, 45)",
    "(2006, pathways, 2)",
    "(2006, openstacks, 7)",
    "(2008, pegsol, 29)",
    "(2014, ged, 1)",
    "(2000, freecell, 32)",
    "(2000, elevators, 40)",
    "(1998, movie, 24)",
    "(2011, visitall, 12)",
    "(1998, assembly, 2)",
    "(2000, elevators, 29)",
    "(2011, scanalyzer, 12)",
    "(2011, openstacks, 17)",
    "(None, miconic, 10)",
    "(2006, tpp, 4)",
    "(2011, barman, 5)",
    "(None, miconic, 79)",
    "(2006, pipesworld, 7)",
    "(2018, termes, 5)",
    "(2018, nurikabe, 20)",
    "(2004, psr-small, 18)",
    "(2018, petri-net-alignment, 4)",
    "(1998, assembly, 10)",
    "(1998, gripper, 8)",
    "(None, miconic, 130)",
    "(1998, gripper, 20)",
    "(None, miconic, 37)",
    "(2008, scanalyzer, 2)",
    "(2000, elevators, 2)",
    "(2000, elevators, 87)",
    "(None, miconic, 9)",
    "(1998, mprime, 26)",
    "(None, openstacks, 9)",
    "(2014, barman, 1)",
    "(2008, sokoban, 2)",
    "(2000, elevators, 145)",
    "(2000, elevators, 67)",
    "(2000, schedule, 145)",
    "(2011, sokoban, 19)",
    "(2018, petri-net-alignment, 10)",
    "(2000, blocks, 56)",
    "(None, ferry, 19)",
    "(None, miconic, 123)",
    "(2000, schedule, 7)",
    "(2008, parcprinter, 5)",
    "(None, miconic, 24)",
    "(1998, movie, 10)",
    "(1998, mprime, 35)",
    "(None, pathways-noneg, 1)",
    "(2014, openstacks, 17)",
    "(2004, pipesworld-notankage, 3)",
    "(2000, elevators, 74)",
    "(None, openstacks, 18)",
    "(2006, pipesworld, 11)",
    "(2011, scanalyzer, 13)",
    "(2011, openstacks, 16)",
    "(None, miconic, 11)",
    "(2006, tpp, 5)",
    "(2011, barman, 4)",
    "(2011, scanalyzer, 8)",
    "(None, miconic, 78)",
    "(2011, openstacks, 1)",
    "(2000, schedule, 66)",
    "(2006, pipesworld, 6)",
    "(2006, openstacks, 6)",
    "(2008, pegsol, 28)",
    "(2000, elevators, 41)",
    "(2000, freecell, 33)",
    "(2004, psr-small, 7)",
    "(1998, movie, 25)",
    "(2000, elevators, 28)",
    "(1998, assembly, 3)",
    "(2011, pegsol, 12)",
    "(1998, movie, 4)",
    "(2018, snake, 4)",
    "(2011, nomystery, 4)",
    "(2006, pathways, 3)",
    "(2002, driverlog, 6)",
    "(2004, psr-small, 44)",
    "(1998, gripper, 15)",
    "(2004, airport, 36)",
    "(2018, nurikabe, 15)",
    "(2000, elevators, 52)",
    "(2006, trucks, 6)",
    "(2008, parcprinter, 24)",
    "(None, no-mprime, 4)",
    "(2006, openstacks, 5)",
    "(2000, elevators, 42)",
    "(2000, freecell, 30)",
    "(None, tsp, 8)",
    "(2014, ged, 3)",
    "(2011, visitall, 10)",
    "(1998, movie, 26)",
    "(None, miconic, 12)",
    "(None, miconic, 115)",
    "(2011, openstacks, 15)",
    "(2000, blocks, 60)",
    "(2011, barman, 7)",
    "(2006, tpp, 6)",
    "(2006, pipesworld, 5)",
    "(2011, openstacks, 2)",
    "(2000, elevators, 51)",
    "(2000, freecell, 23)",
    "(2008, parcprinter, 27)",
    "(2000, elevators, 38)",
    "(2006, trucks, 5)",
    "(2008, openstacks, 29)",
    "(None, miconic, 88)",
    "(2014, visitall, 17)",
    "(None, ferry, 8)",
    "(2011, pegsol, 11)",
    "(2004, pipesworld-notankage, 21)",
    "(2002, driverlog, 5)",
    "(2004, psr-small, 47)",
    "(1998, gripper, 16)",
    "(1998, movie, 7)",
    "(2000, blocks, 3)",
    "(None, miconic, 68)",
    "(2008, sokoban, 29)",
    "(2000, elevators, 1)",
    "(2002, driverlog, 18)",
    "(2008, scanalyzer, 1)",
    "(2008, parcprinter, 12)",
    "(2008, openstacks, 8)",
    "(2014, barman, 2)",
    "(2000, elevators, 64)",
    "(2008, sokoban, 1)",
    "(2000, elevators, 146)",
    "(2006, openstacks, 10)",
    "(1998, mprime, 8)",
    "(2018, termes, 6)",
    "(1998, assembly, 13)",
    "(None, trucks, 8)",
    "(2018, nurikabe, 4)",
    "(2018, petri-net-alignment, 7)",
    "(None, miconic, 34)",
    "(None, miconic, 133)",
    "(2018, organic-synthesis, 6)",
    "(None, no-mprime, 35)",
    "(None, pathways-noneg, 2)",
    "(1998, movie, 13)",
    "(2004, airport, 9)",
    "(2000, elevators, 77)",
    "(2014, openstacks, 14)",
    "(2018, termes, 14)",
    "(None, tsp, 29)",
    "(2018, organic-synthesis-split, 9)",
    "(2006, pipesworld, 12)",
    "(2011, pegsol, 7)",
    "(2004, airport, 13)",
    "(2000, schedule, 146)",
    "(None, miconic, 149)",
    "(2014, thoughtful, 4)",
    "(2018, petri-net-alignment, 13)",
    "(2000, schedule, 4)",
    "(2008, parcprinter, 6)",
    "(None, miconic, 27)",
    "(2000, blocks, 55)",
    "(2011, openstacks, 20)",
    "(None, trucks, 10)",
    "(2000, elevators, 57)",
    "(2000, freecell, 25)",
    "(2011, parcprinter, 9)",
    "(None, grid, 1)",
    "(2006, trucks, 3)",
    "(2002, driverlog, 3)",
    "(2004, psr-small, 41)",
    "(1998, gripper, 10)",
    "(1998, movie, 1)",
    "(2000, blocks, 5)",
    "(2011, nomystery, 1)",
    "(2011, pegsol, 17)",
    "(2000, schedule, 19)",
    "(2004, psr-small, 28)",
    "(2018, nurikabe, 10)",
    "(2004, pipesworld-tankage, 9)",
    "(2000, elevators, 44)",
    "(2014, ged, 5)",
    "(2006, openstacks, 3)",
    "(2006, pipesworld, 21)",
    "(1998, assembly, 6)",
    "(1998, movie, 20)",
    "(2004, psr-small, 2)",
    "(2011, barman, 1)",
    "(2018, petri-net-alignment, 20)",
    "(None, miconic, 14)",
    "(2011, openstacks, 13)",
    "(None, miconic, 113)",
    "(None, ferry, 29)",
    "(2011, sokoban, 8)",
    "(2006, pipesworld, 3)",
    "(2004, airport, 20)",
    "(2011, openstacks, 4)",
    "(None, pathways-noneg, 4)",
    "(2000, elevators, 18)",
    "(1998, movie, 15)",
    "(2004, satellite, 9)",
    "(2002, zenotravel, 18)",
    "(2000, elevators, 71)",
    "(2004, pipesworld-notankage, 6)",
    "(2014, openstacks, 12)",
    "(2018, termes, 12)",
    "(None, miconic, 48)",
    "(2004, airport, 15)",
    "(2000, schedule, 140)",
    "(2000, schedule, 2)",
    "(None, miconic, 21)",
    "(2002, depot, 5)",
    "(2000, blocks, 53)",
    "(None, miconic, 126)",
    "(2014, thoughtful, 2)",
    "(2018, petri-net-alignment, 15)",
    "(2000, elevators, 129)",
    "(2014, barman, 4)",
    "(2000, elevators, 7)",
    "(2000, elevators, 62)",
    "(2000, elevators, 140)",
    "(2008, sokoban, 7)",
    "(2006, openstacks, 16)",
    "(1998, logistics, 5)",
    "(2014, hiking, 18)",
    "(2018, nurikabe, 2)",
    "(2014, hiking, 8)",
    "(2018, petri-net-alignment, 1)",
    "(None, blocks-3op, 29)",
    "(2011, parking, 1)",
    "(None, miconic, 32)",
    "(2004, pipesworld-notankage, 12)",
    "(None, miconic, 135)",
    "(2006, rovers, 8)",
    "(2004, airport, 16)",
    "(2000, schedule, 143)",
    "(None, miconic, 125)",
    "(2000, schedule, 1)",
    "(2008, parcprinter, 3)",
    "(None, miconic, 22)",
    "(2018, petri-net-alignment, 16)",
    "(2014, thoughtful, 1)",
    "(1998, movie, 16)",
    "(2000, elevators, 139)",
    "(2011, pegsol, 2)",
    "(2000, elevators, 150)",
    "(2004, pipesworld-notankage, 5)",
    "(2014, openstacks, 11)",
    "(2002, rovers, 19)",
    "(2018, termes, 11)",
    "(2000, elevators, 72)",
    "(2018, petri-net-alignment, 2)",
    "(None, briefcaseworld, 28)",
    "(2000, schedule, 150)",
    "(2008, sokoban, 19)",
    "(2018, termes, 3)",
    "(None, miconic, 58)",
    "(2000, schedule, 139)",
    "(None, miconic, 136)",
    "(None, miconic, 31)",
    "(2004, pipesworld-notankage, 11)",
    "(2008, scanalyzer, 4)",
    "(2000, elevators, 4)",
    "(2008, openstacks, 19)",
    "(2000, elevators, 143)",
    "(2008, sokoban, 4)",
    "(2006, openstacks, 15)",
    "(2011, visitall, 8)",
    "(2000, elevators, 61)",
    "(1998, movie, 2)",
    "(2000, blocks, 6)",
    "(2011, nomystery, 2)",
    "(2006, pathways, 5)",
    "(2004, psr-small, 42)",
    "(1998, gripper, 13)",
    "(2011, pegsol, 14)",
    "(2018, nurikabe, 13)",
    "(None, trucks, 13)",
    "(2006, pipesworld, 31)",
    "(2000, elevators, 54)",
    "(2014, openstacks, 9)",
    "(2000, freecell, 26)",
    "(1998, movie, 30)",
    "(None, grid, 2)",
    "(2008, parcprinter, 22)",
    "(2006, tpp, 3)",
    "(2011, barman, 2)",
    "(2011, openstacks, 10)",
    "(None, miconic, 17)",
    "(2011, openstacks, 7)",
    "(2004, psr-small, 38)",
    "(2000, elevators, 47)",
    "(2000, freecell, 35)",
    "(None, tsp, 19)",
    "(1998, movie, 23)",
    "(1998, assembly, 5)",
    "(2008, pegsol, 14)",
    "(None, tsp, 23)",
    "(2018, organic-synthesis-split, 3)",
    "(None, openstacks, 11)",
    "(2002, rovers, 16)",
    "(2011, parcprinter, 10)",
    "(2004, airport, 3)",
    "(2000, elevators, 14)",
    "(1998, movie, 19)",
    "(2002, zenotravel, 14)",
    "(2000, elevators, 136)",
    "(2004, satellite, 5)",
    "(None, blocks-3op, 2)",
    "(None, ferry, 10)",
    "(2018, organic-synthesis, 12)",
    "(2000, schedule, 33)",
    "(2018, petri-net-alignment, 19)",
    "(None, miconic, 44)",
    "(None, miconic, 143)",
    "(2011, sokoban, 10)",
    "(2004, airport, 19)",
    "(2006, rovers, 7)",
    "(2011, visitall, 7)",
    "(None, tsp, 30)",
    "(2008, openstacks, 2)",
    "(2000, elevators, 125)",
    "(2011, nomystery, 14)",
    "(2008, openstacks, 16)",
    "(2002, driverlog, 12)",
    "(2000, schedule, 20)",
    "(1998, gripper, 1)",
    "(None, miconic, 139)",
    "(2014, hiking, 14)",
    "(None, trucks, 2)",
    "(2014, hiking, 4)",
    "(None, briefcaseworld, 27)",
    "(2004, psr-small, 11)",
    "(None, miconic, 57)",
    "(None, miconic, 150)",
    "(2008, sokoban, 16)",
    "(2008, scanalyzer, 26)",
    "(2008, openstacks, 23)",
    "(2011, parcprinter, 5)",
    "(2004, pipesworld-tankage, 12)",
    "(2000, elevators, 32)",
    "(2014, openstacks, 6)",
    "(2002, rovers, 7)",
    "(2000, freecell, 29)",
    "(2018, organic-synthesis-split, 17)",
    "(None, miconic, 62)",
    "(2004, psr-small, 24)",
    "(2000, blocks, 10)",
    "(2008, sokoban, 23)",
    "(2004, pipesworld-tankage, 5)",
    "(2000, blocks, 9)",
    "(None, ferry, 2)",
    "(2000, schedule, 15)",
    "(2000, elevators, 21)",
    "(2008, openstacks, 30)",
    "(2000, elevators, 48)",
    "(None, tsp, 2)",
    "(2014, ged, 9)",
    "(None, tsp, 16)",
    "(2011, openstacks, 8)",
    "(2004, psr-small, 37)",
    "(None, miconic, 71)",
    "(2011, scanalyzer, 1)",
    "(2008, sokoban, 30)",
    "(None, miconic, 18)",
    "(2011, sokoban, 4)",
    "(None, ferry, 25)",
    "(2000, blocks, 13)",
    "(2008, sokoban, 20)",
    "(None, miconic, 61)",
    "(2004, psr-small, 27)",
    "(2004, pipesworld-tankage, 6)",
    "(2000, schedule, 16)",
    "(None, ferry, 1)",
    "(2011, pegsol, 18)",
    "(2011, parcprinter, 6)",
    "(2004, pipesworld-tankage, 11)",
    "(2008, openstacks, 20)",
    "(2008, scanalyzer, 25)",
    "(2000, elevators, 113)",
    "(2000, elevators, 31)",
    "(2014, openstacks, 5)",
    "(2000, elevators, 58)",
    "(2002, rovers, 4)",
    "(2002, depot, 12)",
    "(2014, ged, 13)",
    "(2011, scanalyzer, 2)",
    "(2004, psr-small, 34)",
    "(None, miconic, 72)",
    "(2014, visitall, 3)",
    "(2011, sokoban, 7)",
    "(None, ferry, 26)",
    "(1998, assembly, 9)",
    "(2000, elevators, 22)",
    "(2002, rovers, 20)",
    "(2000, freecell, 39)",
    "(2018, snake, 15)",
    "(None, tsp, 15)",
    "(2008, pegsol, 22)",
    "(None, ferry, 13)",
    "(None, miconic, 129)",
    "(None, miconic, 140)",
    "(2006, rovers, 10)",
    "(None, miconic, 47)",
    "(2006, rovers, 4)",
    "(2011, sokoban, 13)",
    "(None, openstacks, 12)",
    "(2008, pegsol, 17)",
    "(None, tsp, 20)",
    "(2004, pipesworld-notankage, 9)",
    "(2002, rovers, 15)",
    "(2011, parcprinter, 13)",
    "(2002, zenotravel, 17)",
    "(2004, satellite, 6)",
    "(2000, elevators, 135)",
    "(2000, elevators, 17)",
    "(1998, gripper, 2)",
    "(None, trucks, 1)",
    "(2014, hiking, 7)",
    "(2014, hiking, 17)",
    "(2008, sokoban, 15)",
    "(2004, psr-small, 12)",
    "(None, miconic, 54)",
    "(2008, sokoban, 8)",
    "(2008, openstacks, 1)",
    "(2000, elevators, 126)",
    "(None, openstacks, 3)",
    "(2011, nomystery, 17)",
    "(2008, openstacks, 15)",
    "(2000, elevators, 8)",
    "(2011, scanalyzer, 4)",
    "(None, miconic, 74)",
    "(2004, psr-small, 32)",
    "(2011, sokoban, 20)",
    "(2011, sokoban, 1)",
    "(None, ferry, 20)",
    "(2014, visitall, 5)",
    "(2011, barman, 8)",
    "(2011, parcprinter, 20)",
    "(1998, movie, 29)",
    "(2000, elevators, 24)",
    "(None, tsp, 13)",
    "(2008, pegsol, 24)",
    "(None, tsp, 7)",
    "(2018, snake, 13)",
    "(2008, sokoban, 26)",
    "(2018, nurikabe, 19)",
    "(2004, psr-small, 21)",
    "(None, miconic, 67)",
    "(2000, schedule, 10)",
    "(None, miconic, 87)",
    "(None, ferry, 7)",
    "(2014, parking, 3)",
    "(1998, movie, 8)",
    "(2000, schedule, 99)",
    "(2004, psr-small, 48)",
    "(1998, gripper, 19)",
    "(2000, elevators, 115)",
    "(2000, elevators, 37)",
    "(2008, openstacks, 26)",
    "(2018, organic-synthesis-split, 12)",
    "(2014, openstacks, 3)",
    "(2002, rovers, 2)",
    "(2008, cybersec, 11)",
    "(1998, gripper, 4)",
    "(2008, sokoban, 13)",
    "(2018, termes, 9)",
    "(None, miconic, 52)",
    "(2014, hiking, 1)",
    "(None, trucks, 7)",
    "(2018, petri-net-alignment, 8)",
    "(2014, hiking, 11)",
    "(2000, elevators, 149)",
    "(2008, cybersec, 24)",
    "(2002, driverlog, 17)",
    "(2011, nomystery, 11)",
    "(2008, openstacks, 13)",
    "(2008, openstacks, 7)",
    "(None, openstacks, 5)",
    "(2018, organic-synthesis, 17)",
    "(1998, logistics, 32)",
    "(None, ferry, 15)",
    "(None, miconic, 28)",
    "(None, fridge, 2)",
    "(2006, rovers, 2)",
    "(2000, schedule, 149)",
    "(2011, sokoban, 15)",
    "(2014, ged, 20)",
    "(None, no-mystery, 9)",
    "(None, miconic, 146)",
    "(None, miconic, 41)",
    "(2008, pegsol, 8)",
    "(2000, elevators, 78)",
    "(None, openstacks, 14)",
    "(2018, organic-synthesis-split, 6)",
    "(2011, pegsol, 8)",
    "(2008, pegsol, 11)",
    "(None, tsp, 26)",
    "(2000, elevators, 133)",
    "(2000, elevators, 11)",
    "(2004, pipesworld-tankage, 31)",
    "(2004, airport, 6)",
    "(2000, elevators, 68)",
    "(1998, mystery, 9)",
    "(2000, elevators, 88)",
    "(2011, nomystery, 12)",
    "(2008, openstacks, 10)",
    "(2002, driverlog, 14)",
    "(2004, pipesworld-tankage, 21)",
    "(2008, openstacks, 4)",
    "(None, openstacks, 6)",
    "(2000, elevators, 123)",
    "(None, miconic, 6)",
    "(None, miconic, 38)",
    "(1998, gripper, 7)",
    "(2000, schedule, 130)",
    "(2000, schedule, 26)",
    "(None, miconic, 51)",
    "(1998, mprime, 4)",
    "(2008, sokoban, 10)",
    "(2014, hiking, 12)",
    "(2004, satellite, 10)",
    "(2014, hiking, 2)",
    "(None, trucks, 4)",
    "(2018, termes, 18)",
    "(2014, openstacks, 18)",
    "(2008, pegsol, 12)",
    "(None, tsp, 25)",
    "(None, openstacks, 17)",
    "(2000, elevators, 12)",
    "(2002, zenotravel, 12)",
    "(2004, satellite, 3)",
    "(2000, elevators, 130)",
    "(1998, logistics, 31)",
    "(None, blocks-3op, 30)",
    "(None, blocks-3op, 4)",
    "(2000, schedule, 8)",
    "(None, ferry, 16)",
    "(2000, blocks, 59)",
    "(2011, sokoban, 16)",
    "(2006, rovers, 1)",
    "(2006, rovers, 15)",
    "(None, miconic, 42)",
    "(None, miconic, 145)",
    "(2000, elevators, 27)",
    "(None, tsp, 10)",
    "(2008, pegsol, 27)",
    "(2006, openstacks, 9)",
    "(None, tsp, 4)",
    "(None, miconic, 77)",
    "(2004, psr-small, 31)",
    "(2014, ged, 16)",
    "(2006, pipesworld, 9)",
    "(2002, depot, 17)",
    "(2011, openstacks, 19)",
    "(2011, sokoban, 2)",
    "(None, ferry, 23)",
    "(2014, visitall, 6)",
    "(2002, zenotravel, 3)",
    "(2000, elevators, 34)",
    "(2006, trucks, 9)",
    "(2008, openstacks, 25)",
    "(2011, parcprinter, 3)",
    "(2002, rovers, 1)",
    "(2018, organic-synthesis-split, 11)",
    "(2004, pipesworld-tankage, 3)",
    "(2004, psr-small, 22)",
    "(None, miconic, 64)",
    "(2008, sokoban, 25)",
    "(2000, schedule, 13)",
    "(None, ferry, 30)"
]



timelimit_map = {
    'fbi-smt' : '00:30:00',
    'fbi-smt-naive' : '00:30:00',
    'fi-bc': '00:45:00',
    'symk': '00:45:00',
}   

def wrap_cmd(taskname, cmd, timelimt, memorylimit, slurmdumpdir):
    return f"""#!/bin/bash
#SBATCH --job-name={taskname}
#SBATCH -e {slurmdumpdir}/{taskname}.error
#SBATCH -o {slurmdumpdir}/{taskname}.output
#SBATCH --cpus-per-task=1
#SBATCH --mem={memorylimit}
#SBATCH --time={timelimt}

{cmd}
"""

def parse_planning_tasks(planningtasksdir:str, resourcesfiledir:str, resourcesdumpdir:str, selected_instances:set):
    # First collect the resoruces information requried.
    resources = _get_resources_details(resourcesfiledir)

    # First collect all the planning tasks from the planning tasks directory.
    planning_domains = _get_planning_domains(planningtasksdir)

    planning_problems = []
    covered_domains = set()

    for domain in planning_domains:
        for domainsroot, _dir, _files in os.walk(domain):
            domainapi = os.path.join(domainsroot, 'api.py')
            _domainbasename = os.path.basename(domainsroot)
            # This is not a valid domain directory.
            if not os.path.exists(domainapi): continue
            # Ignore already processed domains.
            if _domainbasename in covered_domains: continue
            # Process only strips domains.
            if 'adl' in _domainbasename: continue
            _modulename = f'{os.path.basename(domainsroot)}_module'
            module_spec = importlib.util.spec_from_file_location(_modulename, domainapi)
            domain_module = importlib.util.module_from_spec(module_spec)
            module_spec.loader.exec_module(domain_module)
            domainsproblems = deepcopy(domain_module.domains)
            _domainname = domainsproblems[0]['name']
            _ipc_year   = domainsproblems[0]['ipc']
            domainsproblems[0]['problems'].sort(key=lambda x:x[1])
            for no, problem in enumerate(domainsproblems[0]['problems']):
                _instanceno = no+1
                planning_problem                = defaultdict(dict)
                planning_problem['domainname']  = _domainname
                planning_problem['instanceno']  = _instanceno
                planning_problem['ipc_year']    = _ipc_year
                planning_problem['domainfile']  = os.path.join(os.path.dirname(domainsroot), problem[0])
                planning_problem['problemfile'] = os.path.join(os.path.dirname(domainsroot), problem[1])

                # If selected instances are not empty, then filter the instances.
                if len(selected_instances) > 0 and f"({str(_ipc_year)}, {_domainname}, {_instanceno})" not in selected_instances: 
                    continue

                # check if the domain and problem instance has resources.
                resourcesfile = None
                if _ipc_year in resources and _domainname in resources[_ipc_year]:
                    if str(_instanceno) in resources[_ipc_year][_domainname]:
                        # maybe I'll consider this later.
                        # dump the resources to a file. 
                        resourcesfile = os.path.join(resourcesdumpdir, f'{_domainname}_{_instanceno}_resources.txt')
                        with open(resourcesfile, 'w') as f:
                            f.write(resources[_ipc_year][_domainname][str(_instanceno)])
                        planning_problem['resources'] = resourcesfile
                
                if not resourcesfile:
                    planning_problem['resources'] = resourcesfile
                
                # Ignore if the domain or problem file does not exist.
                if not (os.path.exists(planning_problem['domainfile']) and os.path.exists(planning_problem['problemfile'])): 
                    continue
                planning_problems.append(planning_problem)
                covered_domains.add(os.path.basename(domainsroot))
    return planning_problems

def _get_resources_details(resourcesfiledir:str):
    all_resources = defaultdict(dict)
    for root, dirs, files in os.walk(resourcesfiledir):
        for dir_name in dirs:
            domainpath = os.path.join(root, dir_name)
            for resoruce_file in os.listdir(domainpath):
                # load json file and store the data.
                jsonfile = os.path.join(domainpath, resoruce_file)
                with open(jsonfile, 'r') as f:
                    domain_resources = json.load(f)
                year = getkeyvalue(domain_resources, 'year')
                domain = getkeyvalue(domain_resources, 'domain')
                if not year in all_resources: all_resources[year] = defaultdict(dict)
                if not domain in all_resources[year]: all_resources[year][domain] = defaultdict(dict)
                all_resources[year][domain] = domain_resources['instances']
    return all_resources

def _get_planning_domains(directory_path):
    planning_domains = []
    for root, dirs, files in os.walk(directory_path):
        for dir_name in dirs:
            if not os.path.exists(os.path.join(root, dir_name, 'api.py')): continue
            planning_domains.append(os.path.join(root, dir_name))
    return planning_domains

def arg_parser():
    parser = argparse.ArgumentParser(description="Generate SLURM tasks for running experiments.")
    parser.add_argument('--sandbox-dir', type=str, required=True, help='Path to the sandbox directory.')
    parser.add_argument('--planning-tasks-dir', type=str, required=True, help='Directory containing planning tasks.')
    parser.add_argument('--resources-dir', type=str, required=False, default='', help='Directory containing resource files for tasks.')
    parser.add_argument('--planning-type', type=str, required=False, default='classical', help='Type of planning tasks to consider (classical/oversubscription/numerical).')
    return parser

def wrap_tasks_in_slurm_scripts(tasks, slurmdumpdir, timelimit='00:30:00', memorylimit='16G'):
    venv = os.path.join(os.path.dirname(slurmdumpdir), '..', 'venv')
    scriptfile = os.path.join(os.path.dirname(slurmdumpdir), '..', 'paper_experiments', 'run-benchmark.py')
    tasksdir = os.path.join(os.path.dirname(slurmdumpdir), 'tasksdir')
    os.makedirs(tasksdir, exist_ok=True)
    
    resultsdir = os.path.join(os.path.dirname(slurmdumpdir), 'resultsdir')
    os.makedirs(resultsdir, exist_ok=True)

    slurm_scripts = []
    for task in tasks:
        taskfile = os.path.join(tasksdir, f"{task['filename']}")
        with open(taskfile, 'w') as f:
            json.dump(task, f, indent=4)
        rundir = os.path.join(os.path.dirname(slurmdumpdir), 'rundir', task['filename'].replace('.json',''))
        os.makedirs(rundir, exist_ok=True)

        cmd = [f"source {venv}/bin/activate"]
        cmd.append(f"cd {rundir}")
        cmd.append(f"python {scriptfile} --taskfile {taskfile} --outputdir {resultsdir}")
        cmd.append(f"deactivate")
        cmd = " && ".join(cmd)
        slurm_script = wrap_cmd(task['filename'].replace('.json',''), cmd, timelimit_map[task['planner']], memorylimit, slurmdumpdir)
        slurm_scripts.append((task['filename'].replace('.json',''), slurm_script))
    return slurm_scripts

def generate_tasks(planning_tasks_dir, resources_dir, sandboxdir, planning_type):
    _tasks = []
    ru_info_dumps = os.path.join(sandboxdir, 'resource-usage-dumps')
    os.makedirs(ru_info_dumps, exist_ok=True)

    q_list   = []
    planners = []
    selected_instances = set()
    match planning_type:
        case 'classical':
            q_list   = [1.0, 2.0]
            planners = ['fbi-smt', 'fbi-smt-naive', 'fi-bc']
            selected_instances = set(classical_instances)
        case 'oversubscription':
            q_list = [0.25, 0.5, 0.75, 1.0]
            planners = ['fbi-smt', 'fbi-smt-naive', 'symk']
            selected_instances = set(classical_instances)
        case 'numerical':
            q_list = [1.0, 2.0]
            planners = ['fbi-smt', 'fbi-smt-naive']
        case _:
            q_list = []

    for q in q_list:
        for k in [5,10,100,1000]:
            for planner in planners:
                for task in parse_planning_tasks(planning_tasks_dir, resources_dir, ru_info_dumps, selected_instances):
                    _tasks.append(task | { 'sandbox-dir' : sandboxdir, 'planning-type': planning_type, 'planner' : planner, 'q': q, 'k-plans': k, 'filename': f"{q}-{k}-{planning_type}-{task['ipc_year']}-{task['domainname']}-{task['instanceno']}-{planner}.json"})
    return _tasks

def main():
    parser = arg_parser()
    args = parser.parse_args()

    sandbox_dir = args.sandbox_dir
    planning_tasks_dir = args.planning_tasks_dir
    resources_dir = args.resources_dir
    planning_type = args.planning_type
    slurmdumpdir  = os.path.join(sandbox_dir, 'slurm-dumps')
    os.makedirs(slurmdumpdir, exist_ok=True)

    print(f"Generating SLURM scripts for planning tasks in {planning_tasks_dir} with resources from {resources_dir} and planning type {planning_type}...")

    slurm_scripts = wrap_tasks_in_slurm_scripts(generate_tasks(planning_tasks_dir, resources_dir, sandbox_dir, planning_type), slurmdumpdir)

    for idx, (taskname, script) in enumerate(slurm_scripts[::-1]):
        with open(os.path.join(slurmdumpdir, f"{idx}_{taskname}.sh"), 'w') as f:
            f.write(script)

if __name__ == "__main__":
    main()
